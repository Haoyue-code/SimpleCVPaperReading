# NAS的挑战和出路-一份全面的综述

【GiantPandaCV导读】笔者在这篇文章中对《A Comprehensive Survey of Nerual Architecture Search: Challenges and Solutions》这篇进行解读总结，这是2020年刚刚发到arxiv上的有关NAS的综述，内容比较多，30页152篇参考文献。

## 1. 背景

深度学习在很多领域都取得了巨大的突破和进展。这是由于深度学习具有的强大的自动化特征提取的能力。而网络结构的设计对数据的特征的表征和最终模型的表现起到了至关重要的作用。

为了获取数据的更好的特征表示，研究人员设计了多种多样的复杂的网络架构，而网络结构的设计是严重依赖于研究人员的先验知识和经验。同时网络结构的设计也很难跳出原有思考模式并设计出一个最优的网络。萌新很难根据自己的实际任务和需求对网络结构进行合理的修改。

一个很自然的想法就是尽可能减少人工的干预，让算法能够自动寻找最合适的网络架构，这就是网络搜索NAS提出的背景。

近些年很多有关NAS的优秀的工作层出不穷，分别从不同的角度来提升NAS算法。为了让初学者更好的进行NAS相关的研究，一个全面而系统的有关NAS的综述很重要。

**文章组织方式**：先前的关于NAS的综述是从NAS的不同组件的角度进行分析的，但是对初学者不太友好。本篇文章将按照以下方式组织：

- 早期NAS算法的特点。
- 总结早期NAS算法中存在的问题。

- 给出随后的NAS算法对以上问题提出的解决方案。
- 对以上算法继续分析、对比、总结。
- 最后，给出NAS未来可能的发展方向。

## 2. NAS介绍

NAS-神经网络架构搜索，其作用就是取代人工的网络架构设计，在这个过程中尽可能减少人工的干预。

人工设计的网络如ResNet、DenseNet、VGG等结构，实际上也是采用了以下组件组装而成的：

- identity 
- 卷积层（3x3、5x5、7x7）

- 深度可分离卷积
- 空洞卷积
- 组卷积
- 池化层
- Global Average Pooling

- 其他

如果对网络结构的设计进行建模的话，希望通过搜索的方法得到最优的网络结构，这时就需要NAS了。

NAS需要在有限的计算资源达到最好的效果，同时尽可能将更多的步骤自动化。在设计NAS算法的过程通常要考虑几个因素：

- search space 如何定义搜索空间
- search strategy 搜索的策略
- evaluation strategy 评估的策略

## 3. 早期NAS的特征

早期的NAS的结构如下图所示：

![NAS的大体架构](https://img-blog.csdnimg.cn/20201109203458812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0REX1BQX0pK,size_16,color_FFFFFF,t_70#pic_center)

- 找一些预定义的操作集合（eg 卷积、池化等）这些集合构成了Search Space搜索空间。
- 采用一定的搜索策略来获取大量的候选网络结构。
- 在训练集训练这些网络，并且在验证集测试得到这些候选网络的准确率。
- 这些候选网络的准确率会对搜索策略进行反馈，从而可以调整搜索策略来获得新一轮的候选网络。重复这个过程。
- 当终止条件达到（eg:准确率达到某个阈值），搜索就会停下来，这样就可以找到准确率最高对应的网络架构。
- 在测试集上测试最好的网络架构的准确率。

下面介绍的几个网络都是遵从以上的结构进行设计的：

**1. NAS-RL**

NAS-RL发现神经网络的结构可以用一个变长字符串来描述，这样的话就可以使用RNN来作为一个控制器生成一个这样的字符串，然后使用**强化学习算法**来优化控制器，通过这种方法得到最终最优的网络架构。

**2. MetaQNN**

MetaQNN将选择网络架构的过程看作**马尔可夫决策过程**，用**Q-learning**来记录得到的奖励，通过这样的方法得到最优的网络架构。

**3. Large-scale Evolution**

Large-scale Evolution目标是使用**进化算法**(Evolutionary Algorithms)来学习一个最优的网络架构。使用一个最简单的网络结构来初始化种群，通过交叉、突变等方法来选择最优种群。

**4. GeNet**

GeNet也采用了**进化算法**，提出了一个新的神经网络架构编码机制，用定长的二进制串来表征一个网络的结构。GeNet随机初始化一组个体，使用预选定义好的基因操作（将二进制串看作一个个体的基因）来修改二进制串进而产生新的个体，从而最终选择出具有竞争力的个体作为最终的网络架构。

总结一下早期的NAS的特征：

- **全局搜索策略**：早期NAS采用的策略是搜索整个网络的全局，这就意味着NAS需要在非常大的搜搜空间中搜索出一个最优的网络结构。搜索空间越大，计算的代价也就越大。
- **离散的搜索空间**：早期NAS的搜索空间都是离散的，不管是用变长字符串也好，还是用二进制串来表示，他们的搜索空间都是离散的，如果无法连续，那就意味着无法计算梯度，也无法利用梯度策略来调整网络模型架构。
- **从头开始搜索**：每个模型都是从头训练的，这样将无法充分利用现存的网络模型的结构和已经训练得到的参数。

### 3.1 全局搜索

![](https://img-blog.csdnimg.cn/20201109225817417.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0REX1BQX0pK,size_16,color_FFFFFF,t_70#pic_center)















